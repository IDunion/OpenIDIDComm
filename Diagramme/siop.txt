@startuml
!theme vibrant
!pragma teoz true
title "OID4VC + SIOP"
participant Wallet
participant "Issuer" as CI
skinparam ParticipantPadding 75
skinparam sequenceMessageAlign reverseDirection

Wallet <-> CI: ?
|||
alt DidComm <color green>required</color> or <color orange>optional</color>
    CI -> Wallet: SIOP Request
    alt <color green>Required</color>
        Wallet -> CI: ID Token
        group DIDComm
           CI -> Wallet: Ping
           Wallet -> CI: Acknowledge
           CI -> Wallet: OID4VC Response
        end
    else <color orange>Optional</color>
        Wallet -> CI: Cancel
        CI -> Wallet: OID4VC Response
    end
else <color red>Not required</color>
    CI -> Wallet: OID4VC Response
end
|||
Wallet <-> CI: ?
@enduml